function [Torque] = GP_predict(X_train, x_test, alpha, RBD_x_test, Sigma_rbf)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% This function trains a Gaussian Process Regression on the training data
%
% Inputs: - X_train:    (MxP) Matrix containing M datapoints of dimension P
%         - x_test:     (1xP) Vector containing 1 datapoint of dimension P
%         - alpha:      (Mx1) Coefficien vector
%         - RBD_x_test: (double) Rigid body dynamics of the test datapoint
%         - Sigma_rbf:  (double) Hyperparameter, lengthscale of RBF-kernel
%
% Outputs: - Torque:    (double) Torque prediction for new datapoitn x   
%          
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Compute covariance vector applied to all training points
M=size(X_train,1);
K_ = zeros(M,1);

% use paiwise distance function
for i=1:M
    K_(i) = exp(1/(2*Sigma_rbf)*(norm(X_train(i,:)-x_test,2)^2));
end


Torque = RBD_x_test+ sum(alpha.*K_);

end