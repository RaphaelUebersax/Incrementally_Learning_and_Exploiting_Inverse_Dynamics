function [yhat]=cholesky_update(X,Y, sigma_rbf, sigma_n, sigma_f, D, f_mean)

lambda = (sigma_n/sigma_f);
gamma = 1/(2*sigma_rbf^2);

M = size(X,1);
n = size(X,2);
yhat = zeros(M,1);
Y = Y-f_mean;

R=lambda*eye(D);
alpha = zeros(D,1);
beta = zeros(D,1);
Omega = randn(D,n)*sqrt(2*gamma);
b = unifrnd(0,2*pi,D,1);

for i=1:M
    x=X(i,:);
    y=Y(i);
    z = sqrt(2/D)*cos(Omega*x'+b);
    yhat(i) = f_mean(i) + alpha'*z;
    beta = beta + z*y;
    R = cholupdate(R,z);
    alpha = (R'\(R\beta)); 
end
end