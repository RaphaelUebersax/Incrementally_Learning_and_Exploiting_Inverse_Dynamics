function [yhat]=cholesky_update(X,Y, gamma,sigma_n)

[D,n] = size(X);
yhat = zeros(D,1);

R=sigma_n^2*eye(D);
alpha = zeros(D,1);
beta = zeros(D,1);
Omega = randn(D,n)*sqrt(2*gamma);
b = unifrnd(0,2*pi,D,1);

for i=1:D
    x=X(i,:);
    y=Y(i);
    z = sqrt(2/D)*cos(Omega(i,:)*x'+b);
    yhat(i) = alpha'*z;
    beta = beta + z*y;
    R = cholupdate(R,z);
    alpha = (R'\(R\beta)); 
end
end