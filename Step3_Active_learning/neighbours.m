function [idx_neighbours] = neighbours(Candidate_pool,x_current, max_dist)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% THIS FUNCTION RETURNS INDEX OF THE CANDIDAT POOL FOR THE POINTS THAT ARE
% CONSIDERED IN THE NEIGHBOORHOOD OF THE CURRENT DATAPOINT.
%
% Input: - Candidate_pool : (MxP) M datapoints of P-dimensions  
%        - x_current      : (1xP) Last considered datapoint of dimension P
%        - max_dist       : (double) maximum distance to be considered in
%                                    the neighboorhood
%
% Ouput: - idx_neighbours : (1xN) vecotor containing the index of all
%                                 neigbours of x_current
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

distances = pdist2(Candidate_pool, x_current, 'euclidean');
idx_neighbours = find(distances <= max_dist);
while isempty(idx_neighbours)
    max_dist = 2*max_dist;
    idx_neighbours = find(distances <= max_dist);
end

end