function [index_next] = gradient_prop(Candidate_pool, x_current, step, GPR)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% THIS FUNCTION RETURNS INDEX OF THE DATAPOINT IN THE CANDIDATE POOL THAT
% IS CLOSEST TO THE CURRENT DATAPOINT + GRADIENT(VARIANCE)*STEP
%
% Input: - Candidate_pool : (MxP+2) M datapoints of [P-dimensions, target, RBD]
%        - x_current      : (1xP) Last considered datapoint of dimension P
%        - step           : (double) Length of the gradient vector to add
%        - GPR            : (object) Gaussian Process Regressor
%
% Ouput: - idx            : (int) Index of next data in Candidate_pool
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

grad_var = GPR.gradient_var(x_current);
x_new = x_current + step*grad_var;
distances = pdist2(Candidate_pool(:,1:14), x_new, 'squaredeuclidean');
[~,index_next] = min(distances);

end