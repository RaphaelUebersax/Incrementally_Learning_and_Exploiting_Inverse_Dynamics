%% test cholesky

% New point
b = [3;4;3;3];
c = 10;

% Gram
A = [7,3,3,3;3,5,3,3;3,3,6,3;3,3,3,15];
A_star =[A,b;b',c];

% Forward Chol
R = chol(A);
y = R'\b;
z = sqrt(c-y'*y);
R_s = [R,y;zeros(1,length(y)),z];

% check
if (R_s'*R_s - A_star)< 10^(-3)
    disp("Forward works")
end

% Backward chol - based on literature RU_4_...
idx = 3;                                % column/row to delete
w = [zeros(1,idx),R_s(idx,idx+1:end)]';   % update vector depending on index
R_s = cholupdate(R_s,w);                % rank 1 update
R_s(idx,:) = [];                          % delete non-desired row
R_s(:,idx) = [];                          % delete non-desired column

% Check
back = R_s'*R_s;        



