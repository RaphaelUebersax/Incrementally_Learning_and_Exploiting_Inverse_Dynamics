
clear all;
close all;
clc;

addpath("../Tools");
addpath("../Regressors");
rng('default');

plot_constraint = true;



%% 1) Create 2d constrained environment (q,qdot)

% Sample datapoints as constrained environement

sc = 0.1;
% Constraint 1
m1 = sc*[-10;25];	  %Mean
sigma1 = sc^2*10*eye(2);	  %Variance
d1 = 100;             %Length
z1 = mvnrnd(m1,sigma1,d1);


% Constraint 2
m2 = sc*[25;15];     %Mean
sigma2 = sc^2*diag([30;30]);	  %Variance
d2 = 250;             %Length
z2 = mvnrnd(m2,sigma2,d2);

% Constraint 3
m3 = sc*[-25;-5];	%Mean
sigma3 = sc^2*diag([6;30]);	    %Variance
d3 = 300;               %Length
z3 = mvnrnd(m3,sigma3,d3);

if plot_constraint
    figure()
    scatter(z1(:,1),z1(:,2))
    hold on
    scatter(z2(:,1),z2(:,2))
    scatter(z3(:,1),z3(:,2))
    xlabel("q")
    ylabel("qdot")
    title("Task Constraints")
end

X = [z1;z2;z3];
gm = fitgmdist(X,3);

x1 = linspace(-5,5);
x2 = linspace(-5,5);
[X1,X2]=meshgrid(x1,x2);

X1=X1(:);
X2=X2(:);
Y = [X1,X2];
P = posterior(gm,Y);
idx = P(:,2)>0.9;

figure()
scatter(Y(idx,1),Y(idx,2),'r')